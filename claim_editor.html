<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹˜ë£Œ/ê·¹ë³µ ì´ì•¼ê¸° ì‘ì„±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#0055B8',
                            orange: '#F97316',
                            text: '#111827',
                            bg: '#F8F9FA',
                            red: '#DC2626' // Negative Alert Color
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans KR"', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chip-active {
            background-color: #F97316 !important;
            color: white !important;
            border-color: #F97316 !important;
            font-weight: 700 !important;
            box-shadow: 0 2px 4px rgba(249, 115, 22, 0.2);
        }

        .hosp-tag-active {
            background-color: #FFF7ED;
            border-color: #F97316;
            color: #C2410C;
            font-weight: 700;
        }

        /* Default Focus Ring */
        .input-focus-ring:focus-within {
            border-color: #F97316;
            box-shadow: 0 0 0 1px #F97316;
        }

        /* Negative Mode Focus Ring */
        .input-focus-ring.negative-mode:focus-within {
            border-color: #DC2626;
            box-shadow: 0 0 0 1px #DC2626;
        }

        .guide-btn:active { transform: scale(0.95); }

        /* Toggle Switch */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #F97316;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #F97316;
        }
    </style>
</head>
<body class="bg-gray-100 flex justify-center min-h-screen font-sans text-gray-800">

    <div class="w-full max-w-[480px] bg-white relative flex flex-col h-screen shadow-2xl">

        <header class="h-14 px-5 flex items-center justify-between border-b border-gray-100 bg-white z-10 sticky top-0">
            <button class="w-8 h-8 flex items-center justify-start text-gray-800">
                <i class="fas fa-times text-lg"></i>
            </button>
            <h1 class="font-bold text-[17px] tracking-tight">íšŒë³µ ì´ì•¼ê¸° ì‘ì„±</h1>
            <div class="w-8"></div>
        </header>

        <div class="flex-1 overflow-y-auto no-scrollbar pb-32 bg-brand-bg">
            
            <section class="px-5 py-5 bg-white border-b border-gray-100 mb-2">
                <div class="flex items-start gap-3">
                    <div class="w-10 h-10 rounded-full bg-orange-50 border border-orange-100 flex items-center justify-center text-brand-orange flex-shrink-0 shadow-sm">
                        <i class="fa-solid fa-file-invoice-dollar text-lg"></i>
                    </div>
                    <div>
                        <span class="text-[11px] text-gray-500 font-bold block mb-0.5 tracking-tight">ë³´í—˜ê¸ˆ ì§€ê¸‰ í•­ëª©</span>
                        <h2 class="font-bold text-gray-900 text-[15px] leading-tight mb-1">ì¹˜ì£¼ì§ˆí™˜(ì‡ëª¸) ì¹˜ë£Œ ê¸‰ì—¬ê¸ˆ</h2>
                        <p class="text-[11px] text-gray-500">ì§€ê¸‰ì¼ 2024.12.10 <span class="mx-1">|</span> <span class="font-bold text-brand-orange">300,000ì›</span> ì§€ê¸‰ì™„ë£Œ</p>
                    </div>
                </div>
            </section>

            <section class="px-5 py-6 bg-white mb-2 text-center fade-in">
                <label class="block font-bold text-[16px] mb-4" id="rating-title">
                    ì²­êµ¬ë¶€í„° ì§€ê¸‰ê¹Œì§€ <span class="text-brand-orange">í¸ë¦¬</span>í•˜ì…¨ë‚˜ìš”?
                </label>
                <div class="flex justify-center gap-3 mb-3" id="star-container">
                    <i onclick="setRating(1)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(2)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(3)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(4)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(5)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                </div>
                <div class="h-6 flex justify-center items-center">
                    <span id="rating-text" class="text-[13px] font-bold text-brand-orange bg-orange-50 px-3 py-1 rounded-full opacity-0 transition-all scale-90"></span>
                </div>
            </section>

            <section class="px-5 py-6 bg-white mb-2 fade-in transition-all duration-300" id="impact-section" style="animation-delay: 0.1s;">
                <label class="block font-bold text-[16px] mb-3 leading-snug">
                    ì´ë²ˆ ë³´ìƒì´ <span class="text-brand-orange">ì–´ë–¤ ë„ì›€</span>ì´ ë˜ì—ˆë‚˜ìš”?
                    <span class="text-[11px] text-gray-400 font-normal ml-1 block mt-1">(ìµœì†Œ 1ê°œ ì„ íƒ)</span>
                </label>
                <div class="flex flex-wrap gap-2">
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] font-medium transition-all hover:bg-orange-50">ğŸ’¸ ì¹˜ë£Œë¹„ ì „ì•¡/ì¼ë¶€ í•´ê²°</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] font-medium transition-all hover:bg-orange-50">ğŸ’Š ë§˜ í¸íˆ ì¹˜ë£Œì— ì§‘ì¤‘</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] font-medium transition-all hover:bg-orange-50">ğŸ›’ ìƒí™œë¹„/ê°„ë³‘ë¹„ ë³´íƒ¬</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] font-medium transition-all hover:bg-orange-50">ğŸ¥ ì¬í™œ/í›„ì† ì¹˜ë£Œ í™œìš©</button>
                </div>
            </section>

            <section class="px-5 py-6 bg-white mb-2 fade-in" style="animation-delay: 0.3s;">
                <label class="block font-bold text-[16px] mb-1" id="writing-label">
                    ì†”ì§í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”
                </label>
                <p class="text-[12px] text-gray-400 mb-4 font-normal" id="writing-sub">ë¹„ìŠ·í•œ ì•„í””ì„ ê²ªëŠ” ë¶„ë“¤ê»˜ í° í˜ì´ ë©ë‹ˆë‹¤.</p>

                <div class="flex gap-2 mb-3 overflow-x-auto no-scrollbar pb-2" id="hint-container">
                    <button onclick="insertGuide('symptom')" class="guide-btn flex-shrink-0 px-3 py-2 bg-rose-50 text-rose-700 text-[12px] font-bold rounded-lg border border-rose-100">ğŸ¤’ ì²˜ìŒ ì•„íŒ ì„ ë•Œ</button>
                    <button onclick="insertGuide('help')" class="guide-btn flex-shrink-0 px-3 py-2 bg-orange-50 text-brand-orange text-[12px] font-bold rounded-lg border border-orange-100">ğŸ’° ë³´í—˜ê¸ˆì´ ë„ì›€ëœ ì </button>
                    <button onclick="insertGuide('cheer')" class="guide-btn flex-shrink-0 px-3 py-2 bg-teal-50 text-teal-700 text-[12px] font-bold rounded-lg border border-teal-100">ğŸ’ª í˜ë‚´ë¼ëŠ” í•œë§ˆë””</button>
                </div>

                <div class="input-focus-ring border border-gray-300 rounded-xl p-4 transition-all bg-white relative mb-4" id="editor-box">
                    <textarea 
                        id="review-text"
                        class="w-full h-40 resize-none text-[15px] leading-relaxed placeholder-gray-300 focus:outline-none text-gray-700 font-normal"
                        placeholder="ìµœì†Œ 10ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”."
                        oninput="checkLength(this)"
                    ></textarea>
                    <div class="text-right mt-1">
                         <span class="text-[12px] text-gray-400 font-medium"><span id="char-count" class="text-brand-orange font-bold">0</span>/1,000</span>
                    </div>
                </div>

                <div class="mb-4">
                    <h4 class="text-[13px] font-bold text-gray-800 mb-2">ì‚¬ì§„ ì²¨ë¶€ <span class="text-gray-400 font-normal">(ì„ íƒ)</span></h4>
                    <div class="flex gap-3">
                        <button class="w-20 h-20 rounded-xl bg-gray-50 border border-gray-200 flex flex-col items-center justify-center text-gray-400 hover:border-brand-orange hover:text-brand-orange transition-colors">
                            <i class="fa-solid fa-camera text-xl mb-1"></i>
                            <span class="text-[11px] font-medium">0/3</span>
                        </button>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-lg p-3 text-[11px] text-gray-500 leading-relaxed flex gap-2 font-medium">
                    <i class="fas fa-info-circle text-gray-400 mt-0.5"></i>
                    <div>
                        ê°œì¸ì •ë³´(ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸ ë“±)ê°€ í¬í•¨ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•´ì£¼ì„¸ìš”.<br>
                        ì‘ì„±ëœ ê¸€ì€ ìš´ì˜ ì •ì±…ì— ë”°ë¼ ì‹¬ì‚¬ í›„ ë…¸ì¶œë©ë‹ˆë‹¤.
                    </div>
                </div>
            </section>

            <section class="px-5 py-6 bg-white fade-in" style="animation-delay: 0.4s;">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="flex items-center gap-2">
                            <span class="text-brand-orange font-bold text-lg">Plus.</span>
                            <h3 class="font-bold text-[16px] text-gray-900">ë³‘ì› í›„ê¸°</h3>
                            <span class="bg-orange-50 text-brand-orange text-[10px] font-bold px-2 py-0.5 rounded-full border border-orange-100">ì„ íƒ</span>
                        </div>
                        <p class="text-[12px] text-gray-500 mt-1 font-medium">ë‹¤ë…€ì˜¤ì‹  ë³‘ì›ì€ ì–´ë– ì…¨ë‚˜ìš”?</p>
                    </div>
                    
                    <div class="relative inline-block w-12 align-middle select-none transition duration-200 ease-in">
                        <input type="checkbox" name="toggle" id="hospital-toggle" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer transition-all duration-200 ease-in-out left-0"/>
                        <label for="hospital-toggle" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer transition-all duration-200 ease-in-out"></label>
                    </div>
                </div>

                <div id="hospital-content" class="hidden mt-5 pt-5 border-t border-gray-100 space-y-5 transition-all duration-300">
                    <div class="bg-white rounded-2xl border border-gray-200 shadow-sm p-5 relative overflow-hidden">
                        <div class="absolute top-0 left-0 bg-teal-500 text-white text-[10px] font-bold px-3 py-1 rounded-br-lg z-10 shadow-sm">
                            <i class="fas fa-bolt mr-1"></i> ë¼ì´ë‚˜ ì„œë¥˜ì œë¡œ ë³‘ì›
                        </div>
                        <div class="flex items-start gap-3 mt-4 mb-2">
                            <div class="w-12 h-12 rounded-xl bg-gray-50 border border-gray-100 flex items-center justify-center text-gray-400 text-xl">
                                <i class="fas fa-hospital-alt"></i>
                            </div>
                            <div>
                                <h4 class="font-bold text-gray-900 text-[16px]">ì‹ ì´Œì„¸ë¸Œë€ìŠ¤ë³‘ì›</h4>
                                <p class="text-[12px] text-gray-500 mt-0.5 font-medium">ì„œìš¸ ì„œëŒ€ë¬¸êµ¬ ì—°ì„¸ë¡œ 50-1</p>
                            </div>
                        </div>
                    </div>
                    <div>
                        <p class="text-[13px] font-bold text-gray-800 mb-2">ì§„ë£Œ ë§Œì¡±ë„</p>
                        <div class="flex gap-2">
                            <i onclick="rateHospital(1)" class="hosp-star fa-solid fa-star text-2xl text-gray-200 cursor-pointer p-1"></i>
                            <i onclick="rateHospital(2)" class="hosp-star fa-solid fa-star text-2xl text-gray-200 cursor-pointer p-1"></i>
                            <i onclick="rateHospital(3)" class="hosp-star fa-solid fa-star text-2xl text-gray-200 cursor-pointer p-1"></i>
                            <i onclick="rateHospital(4)" class="hosp-star fa-solid fa-star text-2xl text-gray-200 cursor-pointer p-1"></i>
                            <i onclick="rateHospital(5)" class="hosp-star fa-solid fa-star text-2xl text-gray-200 cursor-pointer p-1"></i>
                        </div>
                    </div>
                    <div>
                        <span class="text-[13px] font-bold text-gray-800 block mb-2">ì¢‹ì•˜ë˜ ì  (ë‹¤ì¤‘ì„ íƒ)</span>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="toggleHospTag(this)" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[11px] text-gray-600 font-medium transition-colors hover:border-orange-300">ğŸ‘¨â€âš•ï¸ ê¼¼ê¼¼í•œ ì„¤ëª…</button>
                            <button onclick="toggleHospTag(this)" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[11px] text-gray-600 font-medium transition-colors hover:border-orange-300">ğŸ’‰ í†µì¦ ì—†ëŠ” ì¹˜ë£Œ</button>
                            <button onclick="toggleHospTag(this)" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[11px] text-gray-600 font-medium transition-colors hover:border-orange-300">ğŸ¥ ì¾Œì í•œ ì‹œì„¤</button>
                            <button onclick="toggleHospTag(this)" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[11px] text-gray-600 font-medium transition-colors hover:border-orange-300">âš¡ ë¹ ë¥¸ ì„œë¥˜ ë°œê¸‰</button>
                            <button onclick="toggleHospTag(this)" class="px-3 py-2 bg-white border border-gray-200 rounded-lg text-[11px] text-gray-600 font-medium transition-colors hover:border-orange-300">ğŸ˜Š ì¹œì ˆí•œ ì‘ëŒ€</button>
                        </div>
                    </div>
                    <div>
                        <span class="text-[13px] font-bold text-gray-800 block mb-2">ë³‘ì› í•œì¤„í‰</span>
                        <input type="text" 
                            class="w-full bg-white border border-gray-200 rounded-xl px-4 py-3 text-[13px] font-medium focus:outline-none focus:border-orange-500 transition-colors placeholder-gray-400"
                            placeholder="ì˜ë£Œì§„, ì‹œì„¤, ëŒ€ê¸°ì‹œê°„ ë“± ììœ ë¡­ê²Œ ë‚¨ê²¨ì£¼ì„¸ìš”."
                        >
                    </div>
                </div>
            </section>
        </div>

        <div class="absolute bottom-0 w-full bg-white border-t border-gray-100 p-5 pb-8 z-20 shadow-[0_-5px_30px_rgba(0,0,0,0.04)]">
            <button id="next-btn" class="w-full py-4 rounded-xl font-bold text-[16px] transition-all bg-gray-200 text-gray-400 cursor-not-allowed" disabled onclick="submitReview()">
                í•„ìˆ˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”
            </button>
        </div>

    </div>

    <script>
        // 1. Chip Toggle
        function toggleChip(btn) {
            btn.classList.toggle('chip-active');
            btn.classList.toggle('border-transparent');
            validateForm();
        }

        // 2. Star Rating with Logic Switching
        let currentRating = 0;
        const ratingTexts = ["", "ë¶ˆí¸í–ˆì–´ìš” ğŸ˜¥", "ì¡°ê¸ˆ ëŠë ¸ì–´ìš” ğŸ¢", "ë³´í†µì´ì—ìš” ğŸ™‚", "ë¹¨ëì–´ìš”! âš¡", "ìµœê³ ì—ìš”! ğŸ‘"];
        
        function setRating(score) {
            currentRating = score;
            updateStarUI(score);
            updateEditorMode(score); // Mode Switch
            validateForm();
        }

        function updateStarUI(score) {
            const stars = document.getElementById('star-container').children;
            const textLabel = document.getElementById('rating-text');
            
            for (let i = 0; i < 5; i++) {
                if (i < score) {
                    stars[i].classList.remove('text-gray-200');
                    stars[i].classList.add('text-yellow-400');
                } else {
                    stars[i].classList.remove('text-yellow-400');
                    stars[i].classList.add('text-gray-200');
                }
            }
            textLabel.innerText = ratingTexts[score];
            textLabel.classList.remove('opacity-0', 'scale-90');
            textLabel.classList.add('scale-100');
        }

        // 3. UI Mode Switching (Positive vs Negative)
        function updateEditorMode(score) {
            const isNegative = score <= 2;
            
            const impactSection = document.getElementById('impact-section');
            const writingLabel = document.getElementById('writing-label');
            const writingSub = document.getElementById('writing-sub');
            const hintContainer = document.getElementById('hint-container');
            const editorBox = document.getElementById('editor-box');
            const reviewText = document.getElementById('review-text');

            if (isNegative) {
                // [Negative Mode]
                impactSection.style.display = 'none'; // Hide impact tags
                
                writingLabel.innerHTML = `ì–´ë–¤ ì ì´ <span class="text-brand-red">ì•„ì‰¬ìš°ì…¨ë‚˜ìš”?</span>`;
                writingSub.innerText = "ì†”ì§í•œ ì˜ê²¬ì„ ì£¼ì‹œë©´ ë‹´ë‹¹ìê°€ í™•ì¸ í›„ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤.";

                // Negative Hints (Complaint Focus)
                hintContainer.innerHTML = `
                    <button onclick="insertGuide('neg_speed')" class="guide-btn flex-shrink-0 px-3 py-2 bg-red-50 text-brand-red text-[12px] font-bold rounded-lg border border-red-100">ğŸ¢ ì§€ê¸‰ì´ ë„ˆë¬´ ëŠ¦ì–´ìš”</button>
                    <button onclick="insertGuide('neg_amount')" class="guide-btn flex-shrink-0 px-3 py-2 bg-red-50 text-brand-red text-[12px] font-bold rounded-lg border border-red-100">ğŸ“‰ ê¸ˆì•¡ì´ ìƒê°ë³´ë‹¤ ì ì–´ìš”</button>
                    <button onclick="insertGuide('neg_doc')" class="guide-btn flex-shrink-0 px-3 py-2 bg-red-50 text-brand-red text-[12px] font-bold rounded-lg border border-red-100">ğŸ“„ ì„œë¥˜ê°€ ë³µì¡í•´ìš”</button>
                `;

                editorBox.classList.add('negative-mode');
                reviewText.placeholder = "ë¶ˆí¸í•˜ì…¨ë˜ ì ì„ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì£¼ì‹œë©´, ë¹ ë¥´ê²Œ í™•ì¸í•˜ê² ìŠµë‹ˆë‹¤.";

            } else {
                // [Positive Mode]
                impactSection.style.display = 'block'; // Show impact tags
                
                writingLabel.innerText = "ì†”ì§í•œ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”";
                writingSub.innerText = "ë¹„ìŠ·í•œ ì•„í””ì„ ê²ªëŠ” ë¶„ë“¤ê»˜ í° í˜ì´ ë©ë‹ˆë‹¤.";

                hintContainer.innerHTML = `
                    <button onclick="insertGuide('symptom')" class="guide-btn flex-shrink-0 px-3 py-2 bg-rose-50 text-rose-700 text-[12px] font-bold rounded-lg border border-rose-100">ğŸ¤’ ì²˜ìŒ ì•„íŒ ì„ ë•Œ</button>
                    <button onclick="insertGuide('help')" class="guide-btn flex-shrink-0 px-3 py-2 bg-orange-50 text-brand-orange text-[12px] font-bold rounded-lg border border-orange-100">ğŸ’° ë³´í—˜ê¸ˆì´ ë„ì›€ëœ ì </button>
                    <button onclick="insertGuide('cheer')" class="guide-btn flex-shrink-0 px-3 py-2 bg-teal-50 text-teal-700 text-[12px] font-bold rounded-lg border border-teal-100">ğŸ’ª í˜ë‚´ë¼ëŠ” í•œë§ˆë””</button>
                `;

                editorBox.classList.remove('negative-mode');
                reviewText.placeholder = "ìµœì†Œ 10ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”.";
            }
        }

        // 4. Guide Data
        const guides = {
            // Positive
            'symptom': "ì²˜ìŒ ì¦ìƒì„ ëŠë¼ê³  ë³‘ì›ì— ê°€ì•¼ê² ë‹¤ê³  ìƒê°í–ˆì„ ë•ŒëŠ”,",
            'help': "ì§€ê¸‰ë°›ì€ ë³´í—˜ê¸ˆì´ ê²½ì œì ìœ¼ë¡œ ê°€ì¥ ë„ì›€ì´ ëœ ë¶€ë¶„ì€,",
            'cheer': "ë¹„ìŠ·í•œ ì¦ìƒìœ¼ë¡œ ì¹˜ë£Œë¥¼ ë§ì„¤ì´ëŠ” ë¶„ë“¤ì—ê²Œ í•´ì£¼ê³  ì‹¶ì€ ë§ì€,",
            // Negative (Care)
            'neg_speed': "ë³´í—˜ê¸ˆ ì²­êµ¬ í›„ ì§€ê¸‰ê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ë¶ˆí¸í–ˆë˜ ì ì€,",
            'neg_amount': "ì§€ê¸‰ëœ ë³´í—˜ê¸ˆì´ ì˜ˆìƒë³´ë‹¤ ì ë‹¤ê³  ëŠë¼ì‹  ì´ìœ ëŠ”,",
            'neg_doc': "ì²­êµ¬ ì„œë¥˜ë¥¼ ì¤€ë¹„í•˜ê³  ì œì¶œí•˜ëŠ” ê³¼ì •ì—ì„œ ê°€ì¥ ë²ˆê±°ë¡œì› ë˜ ì ì€,"
        };

        function insertGuide(type) {
            const textarea = document.getElementById('review-text');
            const guideText = guides[type];
            if(textarea.value.trim().length > 0) textarea.value += "\n\n" + guideText + " ";
            else textarea.value = guideText + " ";
            textarea.focus();
            textarea.scrollTop = textarea.scrollHeight;
            checkLength(textarea);
        }

        // 5. Hospital Logic
        const hospToggle = document.getElementById('hospital-toggle');
        const hospContent = document.getElementById('hospital-content');

        hospToggle.addEventListener('change', function() {
            if(this.checked) {
                hospContent.classList.remove('hidden');
                setTimeout(() => { hospContent.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }, 100);
            } else {
                hospContent.classList.add('hidden');
            }
        });

        function rateHospital(value) {
            const stars = document.querySelectorAll('.hosp-star');
            stars.forEach((star, index) => {
                if (index < value) {
                    star.classList.remove('text-gray-200');
                    star.classList.add('text-yellow-400');
                } else {
                    star.classList.remove('text-yellow-400');
                    star.classList.add('text-gray-200');
                }
            });
        }

        function toggleHospTag(btn) {
            btn.classList.toggle('hosp-tag-active');
            btn.classList.toggle('border-transparent');
        }

        // 6. Validation
        function checkLength(el) {
            document.getElementById('char-count').innerText = el.value.length;
            validateForm();
        }

        function validateForm() {
            const hasText = document.getElementById('review-text').value.length >= 10;
            const isNegative = currentRating > 0 && currentRating <= 2;
            const hasRating = currentRating > 0;
            const hasChip = document.querySelector('.chip-active');

            // If Negative, Chip is hidden and not required
            const isValid = isNegative ? (hasRating && hasText) : (hasRating && hasText && hasChip);
            
            const nextBtn = document.getElementById('next-btn');

            if (isValid) {
                nextBtn.disabled = false;
                nextBtn.classList.remove('bg-gray-200', 'text-gray-400', 'cursor-not-allowed');
                
                if (isNegative) {
                    nextBtn.classList.add('bg-brand-text', 'text-white', 'cursor-pointer', 'shadow-lg');
                    nextBtn.innerText = "ë‹´ë‹¹ìì—ê²Œ ì˜ê²¬ ë³´ë‚´ê¸°";
                } else {
                    nextBtn.classList.add('bg-brand-orange', 'text-white', 'cursor-pointer', 'shadow-lg');
                    nextBtn.innerText = "ì‘ì„± ë‚´ìš© í™•ì¸í•˜ê¸°";
                }
            } else {
                nextBtn.disabled = true;
                nextBtn.classList.add('bg-gray-200', 'text-gray-400', 'cursor-not-allowed');
                nextBtn.classList.remove('bg-brand-orange', 'bg-brand-text', 'text-white', 'cursor-pointer', 'shadow-lg');
                nextBtn.innerText = "í•„ìˆ˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”";
            }
        }

        function submitReview() {
            if (currentRating <= 2) {
                alert("[Care Process]\në¶ˆí¸ì„ ë“œë ¤ ì£„ì†¡í•©ë‹ˆë‹¤.\në‹´ë‹¹ìì—ê²Œ ì˜ê²¬ì´ ì „ë‹¬ë˜ì—ˆìœ¼ë©°, í™•ì¸ í›„ ë¹ ë¥´ê²Œ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.");
            } else {
                alert("ë¯¸ë¦¬ë³´ê¸° í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
            }
        }
    </script>
</body>
</html>
