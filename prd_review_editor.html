<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒí’ˆ ë¦¬ë·° ì‘ì„±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            blue: '#0055B8',
                            light: '#F5F9FF',
                            text: '#111827',
                            red: '#DC2626' // For negative feedback highlight
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans KR"', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chip-active {
            background-color: #0055B8 !important;
            color: white !important;
            border-color: #0055B8 !important;
            font-weight: 600 !important;
            box-shadow: 0 2px 4px rgba(0, 85, 184, 0.2);
        }

        .input-focus-ring:focus-within {
            box-shadow: 0 0 0 2px rgba(0, 85, 184, 0.15);
            border-color: #0055B8;
        }
        
        /* Negative Mode Style */
        .input-focus-ring.negative-mode:focus-within {
            box-shadow: 0 0 0 2px rgba(220, 38, 38, 0.15);
            border-color: #DC2626;
        }

        .guide-btn:active { transform: scale(0.95); }
    </style>
</head>
<body class="bg-gray-100 flex justify-center min-h-screen font-sans text-gray-800">

    <div class="w-full max-w-[480px] bg-white relative flex flex-col h-screen shadow-2xl">

        <header class="h-14 px-5 flex items-center justify-between border-b border-gray-100 bg-white z-10 sticky top-0">
            <button class="w-8 h-8 flex items-center justify-start text-gray-800">
                <i class="fas fa-times text-lg"></i>
            </button>
            <h1 class="font-bold text-[17px] tracking-tight">ìƒí’ˆ ë¦¬ë·° ì“°ê¸°</h1>
            <div class="w-8"></div>
        </header>

        <div class="flex-1 overflow-y-auto no-scrollbar pb-32">
            
            <section class="px-5 py-5 bg-gray-50 border-b border-gray-100">
                <div class="flex items-start gap-3">
                    <div class="w-10 h-10 rounded-full bg-white border border-gray-100 flex items-center justify-center text-brand-blue flex-shrink-0 shadow-sm">
                        <i class="fa-solid fa-gift text-lg"></i>
                    </div>
                    <div>
                        <span class="text-[11px] text-gray-500 font-bold block mb-0.5 tracking-tight">REVIEW TARGET</span>
                        <h2 class="font-bold text-gray-900 text-[15px] leading-tight mb-1">(ë¬´)THEê±´ê°•í•œì¹˜ì•„ë³´í—˜V</h2>
                        <p class="text-[11px] text-gray-400">ê°€ì… 2ë…„ì°¨ Â· ì •ìƒìœ ì§€ ì¤‘</p>
                    </div>
                </div>
            </section>

            <section class="px-5 py-6 text-center fade-in">
                <label class="block font-bold text-[16px] mb-4" id="rating-title">
                    ì´ ìƒí’ˆì„ ì§€ì¸ì—ê²Œ <span class="text-brand-blue">ì¶”ì²œ</span>í•˜ì‹œë‚˜ìš”?
                </label>
                <div class="flex justify-center gap-3 mb-3" id="star-container">
                    <i onclick="setRating(1)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(2)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(3)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(4)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                    <i onclick="setRating(5)" class="fa-solid fa-star text-3xl text-gray-200 cursor-pointer transition-colors hover:scale-110 p-1"></i>
                </div>
                <div class="h-6 flex justify-center items-center">
                    <span id="rating-text" class="text-[13px] font-bold text-brand-blue bg-blue-50 px-3 py-1 rounded-full opacity-0 transition-all scale-90"></span>
                </div>
            </section>

            <div class="h-2 bg-gray-50"></div>

            <section class="px-5 py-6 fade-in transition-all duration-300" id="charm-section" style="animation-delay: 0.1s;">
                <label class="block font-bold text-[16px] mb-3 leading-snug">
                    ì´ ìƒí’ˆì˜ <span class="text-brand-blue">ê°€ì¥ í° ë§¤ë ¥</span>ì€ ë¬´ì—‡ì¸ê°€ìš”?
                    <span class="text-[11px] text-gray-400 font-normal ml-1 block mt-1">(ìµœì†Œ 1ê°œ ì„ íƒ)</span>
                </label>
                <div class="flex flex-wrap gap-2">
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] transition-all hover:bg-gray-50">ğŸ’° ê°€ì„±ë¹„/ë³´í—˜ë£Œ</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] transition-all hover:bg-gray-50">ğŸ›¡ï¸ ë“ ë“ í•œ ë³´ì¥ë²”ìœ„</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] transition-all hover:bg-gray-50">ğŸ¢ ë¸Œëœë“œ ì‹ ë¢°ë„</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] transition-all hover:bg-gray-50">âš¡ ê°„í¸í•œ ì²­êµ¬/ê´€ë¦¬</button>
                    <button onclick="toggleChip(this)" class="px-3.5 py-2.5 rounded-xl border border-gray-200 bg-white text-gray-600 text-[13px] transition-all hover:bg-gray-50">ğŸ ë¶€ê°€ í˜œíƒ/ì„œë¹„ìŠ¤</button>
                </div>
            </section>

            <div class="h-2 bg-gray-50" id="charm-divider"></div>

            <section class="px-5 py-6 fade-in" style="animation-delay: 0.3s;">
                <label class="block font-bold text-[16px] mb-1" id="writing-label">
                    ì†”ì§í•œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”
                </label>
                <p class="text-[12px] text-gray-400 mb-4" id="writing-sub">ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¬¸ì¥ì´ ìë™ìœ¼ë¡œ ì‹œì‘ë¼ìš”!</p>

                <div class="flex gap-2 mb-3 overflow-x-auto no-scrollbar pb-2" id="hint-container">
                    <button onclick="insertGuide('reason')" class="guide-btn flex-shrink-0 px-3 py-2 bg-blue-50 text-brand-blue text-[12px] font-bold rounded-lg border border-blue-100">ğŸ’¡ ê²°ì •ì  ê°€ì…ì´ìœ </button>
                    <button onclick="insertGuide('price')" class="guide-btn flex-shrink-0 px-3 py-2 bg-blue-50 text-brand-blue text-[12px] font-bold rounded-lg border border-blue-100">ğŸ’° ê°€ê²©/ë³´ì¥ í‰ê°€</button>
                    <button onclick="insertGuide('recommend')" class="guide-btn flex-shrink-0 px-3 py-2 bg-purple-50 text-purple-700 text-[12px] font-bold rounded-lg border border-purple-100">ğŸ‘ ì´ëŸ° ë¶„ê»˜ ì¶”ì²œ</button>
                </div>

                <div class="input-focus-ring border border-gray-300 rounded-xl p-4 transition-all bg-white relative" id="editor-box">
                    <textarea 
                        id="review-text"
                        class="w-full h-40 resize-none text-[15px] leading-relaxed placeholder-gray-300 focus:outline-none text-gray-700"
                        placeholder="ìµœì†Œ 10ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”."
                        oninput="checkLength(this)"
                    ></textarea>
                    
                    <div class="flex justify-between items-center mt-3 pt-3 border-t border-gray-100">
                        <button class="flex items-center gap-1.5 text-gray-500 hover:text-brand-blue transition-colors px-2 py-1 rounded hover:bg-gray-50">
                            <i class="fa-solid fa-camera text-lg"></i>
                            <span class="text-[12px] font-medium">ì‚¬ì§„ ì²¨ë¶€ (0/3)</span>
                        </button>
                        <span class="text-[12px] text-gray-400"><span id="char-count" class="text-brand-blue font-bold">0</span>/1,000</span>
                    </div>
                </div>
            </section>
        </div>

        <div class="absolute bottom-0 w-full bg-white border-t border-gray-100 p-5 pb-8 z-20 shadow-[0_-5px_30px_rgba(0,0,0,0.04)]">
            <button id="next-btn" class="w-full py-4 rounded-xl font-bold text-[16px] transition-all bg-gray-200 text-gray-400 cursor-not-allowed" disabled onclick="submitReview()">
                í•„ìˆ˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”
            </button>
        </div>

    </div>

    <script>
        // 1. Chip Toggle
        function toggleChip(btn) {
            btn.classList.toggle('chip-active');
            btn.classList.toggle('border-transparent');
            validateForm();
        }

        // 2. Dynamic Rating Logic (Core Update)
        let currentRating = 0;
        const ratingTexts = ["", "ë¹„ì¶”ì²œí•´ìš” ğŸ˜¢", "ë§ì´ ì•„ì‰¬ì›Œìš” ğŸ˜“", "ë³´í†µì´ì—ìš” ğŸ™‚", "ì¶”ì²œí•´ìš”! ğŸ‘", "ê°•ë ¥ ì¶”ì²œí•´ìš”! ğŸ’–"];
        
        function setRating(score) {
            currentRating = score;
            updateStarUI(score);
            updateEditorMode(score); // Mode Switch Logic
            validateForm();
        }

        function updateStarUI(score) {
            const stars = document.getElementById('star-container').children;
            const textLabel = document.getElementById('rating-text');
            
            for (let i = 0; i < 5; i++) {
                if (i < score) {
                    stars[i].classList.remove('text-gray-200');
                    stars[i].classList.add('text-yellow-400');
                } else {
                    stars[i].classList.remove('text-yellow-400');
                    stars[i].classList.add('text-gray-200');
                }
            }
            textLabel.innerText = ratingTexts[score];
            textLabel.classList.remove('opacity-0', 'scale-90');
            textLabel.classList.add('scale-100');
        }

        // 3. UI Mode Switching (Positive vs Negative)
        function updateEditorMode(score) {
            const isNegative = score <= 2;
            
            // Section Elements
            const charmSection = document.getElementById('charm-section');
            const charmDivider = document.getElementById('charm-divider');
            const writingLabel = document.getElementById('writing-label');
            const writingSub = document.getElementById('writing-sub');
            const hintContainer = document.getElementById('hint-container');
            const editorBox = document.getElementById('editor-box');
            const reviewText = document.getElementById('review-text');

            if (isNegative) {
                // [Negative Mode]
                // 1. Hide Charm Section
                charmSection.style.display = 'none';
                charmDivider.style.display = 'none';

                // 2. Change Labels
                writingLabel.innerHTML = `ì–´ë–¤ ì ì´ <span class="text-brand-red">ì•„ì‰¬ìš°ì…¨ë‚˜ìš”?</span>`;
                writingSub.innerText = "ì†”ì§í•œ ì˜ê²¬ì„ ì£¼ì‹œë©´ ë‹´ë‹¹ìê°€ í™•ì¸ í›„ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤.";

                // 3. Change Hints (Complaint Keywords)
                hintContainer.innerHTML = `
                    <button onclick="insertGuide('neg_process')" class="guide-btn flex-shrink-0 px-3 py-2 bg-red-50 text-brand-red text-[12px] font-bold rounded-lg border border-red-100">ğŸ˜¡ ì ˆì°¨ê°€ ë³µì¡í•´ìš”</button>
                    <button onclick="insertGuide('neg_counsel')" class="guide-btn flex-shrink-0 px-3 py-2 bg-red-50 text-brand-red text-[12px] font-bold rounded-lg border border-red-100">ğŸ˜“ ìƒë‹´ì´ ë¶ˆì¹œì ˆí•´ìš”</button>
                    <button onclick="insertGuide('neg_benefit')" class="guide-btn flex-shrink-0 px-3 py-2 bg-red-50 text-brand-red text-[12px] font-bold rounded-lg border border-red-100">ğŸ“‰ ë³´ì¥ì´ ë¶€ì¡±í•´ìš”</button>
                `;

                // 4. Style Changes
                editorBox.classList.add('negative-mode');
                reviewText.placeholder = "ë¶ˆí¸í•˜ì…¨ë˜ ì ì„ êµ¬ì²´ì ìœ¼ë¡œ ì ì–´ì£¼ì‹œë©´, ë¹ ë¥´ê²Œ í™•ì¸í•˜ê² ìŠµë‹ˆë‹¤.";

            } else {
                // [Positive Mode] - Restore
                charmSection.style.display = 'block';
                charmDivider.style.display = 'block';

                writingLabel.innerText = "ì†”ì§í•œ ë¦¬ë·°ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”";
                writingSub.innerText = "ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë¬¸ì¥ì´ ìë™ìœ¼ë¡œ ì‹œì‘ë¼ìš”!";

                hintContainer.innerHTML = `
                    <button onclick="insertGuide('reason')" class="guide-btn flex-shrink-0 px-3 py-2 bg-blue-50 text-brand-blue text-[12px] font-bold rounded-lg border border-blue-100">ğŸ’¡ ê²°ì •ì  ê°€ì…ì´ìœ </button>
                    <button onclick="insertGuide('price')" class="guide-btn flex-shrink-0 px-3 py-2 bg-blue-50 text-brand-blue text-[12px] font-bold rounded-lg border border-blue-100">ğŸ’° ê°€ê²©/ë³´ì¥ í‰ê°€</button>
                    <button onclick="insertGuide('recommend')" class="guide-btn flex-shrink-0 px-3 py-2 bg-purple-50 text-purple-700 text-[12px] font-bold rounded-lg border border-purple-100">ğŸ‘ ì´ëŸ° ë¶„ê»˜ ì¶”ì²œ</button>
                    <button onclick="insertGuide('health')" class="guide-btn flex-shrink-0 px-3 py-2 bg-purple-50 text-purple-700 text-[12px] font-bold rounded-lg border border-purple-100">ğŸ’ª ê±´ê°•ê´€ë¦¬ ë‹¤ì§</button>
                `;

                editorBox.classList.remove('negative-mode');
                reviewText.placeholder = "ìµœì†Œ 10ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”.";
            }
        }

        // 4. Guide Text Data
        const guides = {
            // Positive
            'reason': "ì œê°€ ì´ ìƒí’ˆì„ ì„ íƒí•˜ê²Œ ëœ ê²°ì •ì ì¸ ì´ìœ ëŠ”,",
            'price': "ë‹¤ë¥¸ ë³´í—˜ê³¼ ë¹„êµí–ˆì„ ë•Œ ê°€ê²©ì´ë‚˜ ë³´ì¥ êµ¬ì„±ì´,",
            'recommend': "ì´ ìƒí’ˆì€ íŠ¹íˆ ì´ëŸ° ë¶„ë“¤ì—ê²Œ ì¶”ì²œí•˜ê³  ì‹¶ì–´ìš”.",
            'health': "ì•ìœ¼ë¡œ ê±´ê°• ê´€ë¦¬ë¥¼ ìœ„í•´ ì´ë ‡ê²Œ ë…¸ë ¥í•  ê±°ì˜ˆìš”.",
            // Negative (Care)
            'neg_process': "ê°€ì…/ì²­êµ¬ ì ˆì°¨ë¥¼ ì§„í–‰í•˜ë©´ì„œ ê°€ì¥ ë¶ˆí¸í–ˆë˜ ì ì€,",
            'neg_counsel': "ìƒë‹´ ê³¼ì •ì—ì„œ ì•„ì‰¬ì›€ì„ ëŠê¼ˆë˜ ë¶€ë¶„ì€,",
            'neg_benefit': "ìƒê°í–ˆë˜ ê²ƒë³´ë‹¤ ë³´ì¥ ë‚´ìš©ì´ ë¶€ì¡±í•˜ë‹¤ê³  ëŠë‚€ ì ì€,"
        };

        function insertGuide(type) {
            const textarea = document.getElementById('review-text');
            const guideText = guides[type];
            
            if(textarea.value.trim().length > 0) textarea.value += "\n\n" + guideText + " ";
            else textarea.value = guideText + " ";
            
            textarea.focus();
            textarea.scrollTop = textarea.scrollHeight;
            checkLength(textarea);
        }

        // 5. Validation
        function checkLength(el) {
            document.getElementById('char-count').innerText = el.value.length;
            validateForm();
        }

        function validateForm() {
            // Logic differs by rating
            const isNegative = currentRating > 0 && currentRating <= 2;
            const hasRating = currentRating > 0;
            const hasText = document.getElementById('review-text').value.length >= 10;
            const hasChip = document.querySelector('.chip-active');
            
            // If Negative, Chip is hidden, so not required
            const isValid = isNegative ? (hasRating && hasText) : (hasRating && hasText && hasChip);
            
            const nextBtn = document.getElementById('next-btn');

            if (isValid) {
                nextBtn.disabled = false;
                nextBtn.classList.remove('bg-gray-200', 'text-gray-400', 'cursor-not-allowed');
                
                if (isNegative) {
                    nextBtn.classList.add('bg-brand-text', 'text-white', 'cursor-pointer', 'shadow-lg'); // Dark Button for serious tone
                    nextBtn.innerText = "ë‹´ë‹¹ìì—ê²Œ ì˜ê²¬ ë³´ë‚´ê¸°";
                } else {
                    nextBtn.classList.add('bg-brand-blue', 'text-white', 'cursor-pointer', 'shadow-lg');
                    nextBtn.innerText = "ì‘ì„± ë‚´ìš© í™•ì¸í•˜ê¸°";
                }
            } else {
                nextBtn.disabled = true;
                nextBtn.classList.add('bg-gray-200', 'text-gray-400', 'cursor-not-allowed');
                nextBtn.classList.remove('bg-brand-blue', 'bg-brand-text', 'text-white', 'cursor-pointer', 'shadow-lg');
                nextBtn.innerText = "í•„ìˆ˜ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”";
            }
        }

        // 6. Submit Action (Care Pop-up Placeholder)
        function submitReview() {
            if (currentRating <= 2) {
                alert("[Care Process]\në¶ˆí¸ì„ ë“œë ¤ ì£„ì†¡í•©ë‹ˆë‹¤.\nì‘ì„±í•´ì£¼ì‹  ì˜ê²¬ì€ ë‹´ë‹¹ìì—ê²Œ 'ê¸´ê¸‰ ì ‘ìˆ˜' ë˜ì—ˆìŠµë‹ˆë‹¤.\n\n(ì‹¤ì œë¡œëŠ” VoC ì ‘ìˆ˜ í”„ë¡œì„¸ìŠ¤ë¡œ ì—°ê²°)");
            } else {
                alert("ë¯¸ë¦¬ë³´ê¸° í™”ë©´ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
            }
        }
    </script>
</body>
</html>
